"""
設定ファイル - パス、定数、マスターデータの定義
"""
from pathlib import Path
from typing import Dict

# プロジェクトルート
PROJECT_ROOT = Path(__file__).parent

# ディレクトリパス
DATA_DIR = PROJECT_ROOT / "data"
DOWNLOAD_DIR = DATA_DIR / "download"
OUTPUT_DIR = PROJECT_ROOT / "output"
RAW_DIR = OUTPUT_DIR / "raw"
NORMALIZED_DIR = OUTPUT_DIR / "normalized"
PROCESSED_DIR = OUTPUT_DIR / "processed"
SCHEMA_DIR = OUTPUT_DIR / "schema"

# ファイル名と年度のマッピング
FILENAME_TO_YEAR: Dict[str, int] = {
    "database2014.xlsx": 2014,  # 26年度
    "database2015.xlsx": 2015,  # 27年度
    "database2016.xlsx": 2016,  # 28年度
    "database2017.xlsx": 2017,  # 29年度
    "database2018_220427.xlsx": 2018,  # 30年度
    "database2019_220427.xlsx": 2019,  # 令和元年度
    "database_220427.xlsx": 2020,  # 令和２年度
    "database220524.xlsx": 2021,  # 令和３年度
    "database240502.zip": 2022,  # 令和４年度
    "database240918.zip": 2023,  # 令和５年度
}

# 府省庁マスターデータ（RSシステムの建制順に対応）
MINISTRY_MASTER = [
    {"id": 1, "name": "内閣官房"},
    {"id": 2, "name": "内閣府"},
    {"id": 3, "name": "復興庁"},
    {"id": 4, "name": "デジタル庁"},
    {"id": 5, "name": "国家公安委員会（警察庁）"},
    {"id": 6, "name": "個人情報保護委員会"},
    {"id": 7, "name": "カジノ管理委員会"},
    {"id": 8, "name": "金融庁"},
    {"id": 9, "name": "消費者庁"},
    {"id": 10, "name": "こども家庭庁"},
    {"id": 11, "name": "総務省"},
    {"id": 12, "name": "公害等調整委員会"},
    {"id": 13, "name": "消防庁"},
    {"id": 14, "name": "法務省"},
    {"id": 15, "name": "公安審査委員会"},
    {"id": 16, "name": "公安調査庁"},
    {"id": 17, "name": "外務省"},
    {"id": 18, "name": "財務省"},
    {"id": 19, "name": "国税庁"},
    {"id": 20, "name": "文部科学省"},
    {"id": 21, "name": "スポーツ庁"},
    {"id": 22, "name": "文化庁"},
    {"id": 23, "name": "厚生労働省"},
    {"id": 24, "name": "中央労働委員会"},
    {"id": 25, "name": "農林水産省"},
    {"id": 26, "name": "林野庁"},
    {"id": 27, "name": "水産庁"},
    {"id": 28, "name": "経済産業省"},
    {"id": 29, "name": "資源エネルギー庁"},
    {"id": 30, "name": "特許庁"},
    {"id": 31, "name": "中小企業庁"},
    {"id": 32, "name": "国土交通省"},
    {"id": 33, "name": "観光庁"},
    {"id": 34, "name": "気象庁"},
    {"id": 35, "name": "運輸安全委員会"},
    {"id": 36, "name": "海上保安庁"},
    {"id": 37, "name": "環境省"},
    {"id": 38, "name": "原子力規制委員会"},
    {"id": 39, "name": "防衛省"},
    {"id": 40, "name": "防衛装備庁"},
    {"id": 99, "name": "会計検査院"},
]

# 府省名の表記揺れマッピング
MINISTRY_NAME_MAPPING: Dict[str, str] = {
    "内閣官房": "内閣官房",
    "内閣府": "内閣府",
    "警察庁": "国家公安委員会（警察庁）",
    "金融庁": "金融庁",
    "消費者庁": "消費者庁",
    "総務省": "総務省",
    "消防庁": "消防庁",
    "法務省": "法務省",
    "外務省": "外務省",
    "財務省": "財務省",
    "国税庁": "国税庁",
    "文部科学省": "文部科学省",
    "文科省": "文部科学省",
    "文化庁": "文化庁",
    "厚生労働省": "厚生労働省",
    "厚労省": "厚生労働省",
    "農林水産省": "農林水産省",
    "農水省": "農林水産省",
    "林野庁": "林野庁",
    "水産庁": "水産庁",
    "経済産業省": "経済産業省",
    "経産省": "経済産業省",
    "特許庁": "特許庁",
    "中小企業庁": "中小企業庁",
    "国土交通省": "国土交通省",
    "国交省": "国土交通省",
    "観光庁": "観光庁",
    "気象庁": "気象庁",
    "海上保安庁": "海上保安庁",
    "環境省": "環境省",
    "防衛省": "防衛省",
    "会計検査院": "会計検査院",
    "復興庁": "復興庁",
    "デジタル庁": "デジタル庁",
    "個人情報保護委員会": "個人情報保護委員会",
    "こども家庭庁": "こども家庭庁",
    "スポーツ庁": "スポーツ庁",
    "原子力規制委員会": "原子力規制委員会",
}

# RSシステムの標準カラム定義
RS_STANDARD_COLUMNS = {
    "common": [
        "シート種別",
        "事業年度",
        "予算事業ID",
        "事業名",
        "府省庁の建制順",
        "政策所管府省庁",
        "府省庁",
        "局・庁",
        "部",
        "課",
        "室",
        "班",
        "係",
    ],
    "project_overview": [
        "事業の目的",
        "現状・課題",
        "事業の概要",
        "事業区分",
        "事業開始年度",
        "開始年度不明",
        "事業終了(予定)年度",
        "終了予定なし",
    ],
    "budget_summary": [
        "予算年度",
        "計(歳出予算現額合計)",
        "執行額(合計)",
        "執行率",
        "会計区分",
    ],
    "expenditure": [
        "支出先ブロック",
        "支出先番号",
        "支出先名",
        "法人番号",
        "業務概要",
        "支出額（百万円）",
        "契約方式等",
        "入札者数（応募者数）",
        "落札率",
        "一者応札理由",
    ],
}
